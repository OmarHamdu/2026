<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KINGS TECH OS | V10.5 Complete Adhkar</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-darker: #020617;
            --glass-bg: rgba(30, 41, 59, 0.7);
            --glass-border: rgba(255, 255, 255, 0.08);
            --primary: #3b82f6;
            --primary-glow: rgba(59, 130, 246, 0.4);
            --accent: #f59e0b;
            --text: #f8fafc;
            --text-muted: #94a3b8;
            --success: #10b981;
            --danger: #ef4444;
            --sidebar-width: 280px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg-dark); 
            background-image: 
                radial-gradient(circle at 0% 0%, rgba(59, 130, 246, 0.1) 0px, transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(245, 158, 11, 0.08) 0px, transparent 50%);
            color: var(--text); 
            display: flex; 
            min-height: 100vh; 
            overflow: hidden; 
            font-size: 16px;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }

        /* --- Header --- */
        .top-bar {
            position: fixed; top: 0; left: 0; right: 0;
            height: 60px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--glass-border);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            transition: 0.3s;
        }
        .toggle-btn { background: transparent; border: none; color: white; font-size: 1.2rem; cursor: pointer; display: none; }
        .clock-area { text-align: left; display: flex; align-items: center; gap: 15px; }
        .time-display { font-size: 1.2rem; font-weight: 700; color: var(--primary); text-shadow: 0 0 10px var(--primary-glow); }
        .date-display { font-size: 0.85rem; color: var(--text-muted); }
        .greeting { font-weight: 600; color: var(--accent); }

        /* --- Sidebar --- */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-darker);
            border-left: 1px solid var(--glass-border);
            padding: 20px;
            display: flex; flex-direction: column; gap: 5px;
            z-index: 900;
            overflow-y: auto;
            position: relative;
            transition: transform 0.3s ease-in-out;
            margin-top: 60px; height: calc(100vh - 60px);
        }
        .brand {
            font-size: 1.5rem; font-weight: 900; color: white;
            text-align: center; margin-bottom: 30px; letter-spacing: -0.5px;
            display: flex; flex-direction: column; align-items: center;
        }
        .brand i { font-size: 1.8rem; color: var(--primary); margin-bottom: 5px; }
        .brand span { color: var(--text-muted); font-size: 0.75rem; letter-spacing: 2px; font-weight: 600; margin-top: 5px; background: rgba(255,255,255,0.05); padding: 2px 10px; border-radius: 10px; }
        .nav-section { font-size: 0.7rem; color: #64748b; margin-top: 20px; font-weight: 900; padding-right: 15px; text-transform: uppercase; }
        .nav-btn {
            background: transparent; border: none; color: #cbd5e1;
            padding: 12px 15px; text-align: right; cursor: pointer; font-size: 0.95rem;
            border-radius: 12px; transition: 0.2s; display: flex; align-items: center; gap: 12px; font-weight: 500;
        }
        .nav-btn i { width: 20px; text-align: center; color: var(--text-muted); transition: 0.2s; }
        .nav-btn:hover { background: rgba(255,255,255,0.03); color: white; transform: translateX(-5px); }
        .nav-btn:hover i { color: var(--primary); }
        .nav-btn.active { background: linear-gradient(90deg, rgba(59, 130, 246, 0.1), transparent); color: var(--primary); border-right: 3px solid var(--primary); }
        .nav-btn.active i { color: var(--primary); }

        /* --- Main Content --- */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; height: calc(100vh - 60px); margin-top: 60px; scroll-behavior: smooth; }
        .page { display: none; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); padding-bottom: 50px; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        h2 { font-size: 1.8rem; margin-bottom: 25px; color: white; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid var(--glass-border); padding-bottom: 15px; }
        h2 i { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; font-size: 1.2rem; }

        /* --- Cards --- */
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 20px; }
        .col-span-12 { grid-column: span 12; } .col-span-8 { grid-column: span 8; } .col-span-6 { grid-column: span 6; } .col-span-4 { grid-column: span 4; }
        
        .card {
            background: var(--glass-bg); backdrop-filter: blur(12px); border: 1px solid var(--glass-border);
            padding: 25px; border-radius: 20px; transition: 0.3s; display: flex; flex-direction: column;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden;
        }
        .card:hover { border-color: rgba(59, 130, 246, 0.3); transform: translateY(-3px); }
        .card-header { font-size: 1.1rem; font-weight: 700; margin-bottom: 20px; color: #e2e8f0; display: flex; justify-content: space-between; align-items: center; }

        /* --- Inputs & Buttons --- */
        input[type="text"], textarea, input[type="number"], select {
            width: 100%; padding: 14px; background: rgba(0,0,0,0.3); border: 1px solid #334155;
            border-radius: 12px; color: white; margin-bottom: 12px; outline: none; transition: 0.3s; font-size: 0.95rem;
        }
        input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
        .btn {
            background: linear-gradient(135deg, var(--primary), #2563eb); color: white; border: none; padding: 10px 20px;
            border-radius: 10px; cursor: pointer; font-weight: 600; transition: 0.2s; font-size: 0.9rem;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.3);
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-danger { background: var(--danger); box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3); }
        .btn-warning { background: var(--accent); color: black; box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.3); }
        .btn-outline { background: transparent; border: 1px solid var(--text-muted); color: var(--text-muted); }
        .btn-ai { background: linear-gradient(135deg, #8b5cf6, #d946ef); color: white; }

        /* --- Lists --- */
        ul { list-style: none; flex: 1; }
        li {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 15px; background: rgba(255,255,255,0.02); margin-bottom: 8px; border-radius: 10px;
            border: 1px solid transparent; transition: 0.2s;
        }
        li:hover { background: rgba(255,255,255,0.05); }
        .task-actions { display: flex; gap: 8px; }
        .action-btn { padding: 5px 10px; border-radius: 6px; cursor: pointer; border: none; font-size: 0.8rem; transition: 0.2s; }
        .done-btn { background: var(--success); color: white; }
        .done-btn:hover { background: #059669; }
        .accumulated-item { border-right: 3px solid var(--danger); }

        /* --- Specific Styles --- */
        .rank-badge { font-size: 1.5rem; font-weight: 900; color: var(--accent); }
        .best-day-card { background: linear-gradient(45deg, rgba(245, 158, 11, 0.1), rgba(0,0,0,0)); border: 1px solid rgba(245, 158, 11, 0.3); }
        
        /* Adhkar Styles */
        .adhkar-container { display: flex; flex-direction: column; gap: 15px; }
        .dhikr-card {
            background: rgba(15, 23, 42, 0.95); border: 1px solid #334155; padding: 20px; border-radius: 12px;
            position: relative; cursor: pointer; user-select: none; transition: 0.2s;
        }
        .dhikr-card:hover { border-color: var(--primary); transform: scale(1.005); }
        .dhikr-card:active { transform: scale(0.99); background: #1e293b; }
        .dhikr-text { font-size: 1.1rem; line-height: 1.8; margin-bottom: 15px; color: #e2e8f0; text-align: justify; font-family: 'Cairo', sans-serif; }
        .dhikr-footer { display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; color: var(--text-muted); border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px; }
        .count-badge { background: var(--accent); color: black; padding: 5px 15px; border-radius: 20px; font-weight: bold; min-width: 45px; text-align: center; font-size: 1rem; box-shadow: 0 0 10px rgba(245, 158, 11, 0.3); }
        .dhikr-card.done { opacity: 0.5; border-color: var(--success); pointer-events: none; }
        .dhikr-card.done .count-badge { background: var(--success); color: white; }

        /* Quote Card */
        .quote-card { text-align: center; border-color: var(--primary); background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), transparent); }
        .quote-text { font-size: 1.1rem; font-style: italic; color: #cbd5e1; margin-bottom: 10px; }

        /* --- Responsive --- */
        @media (max-width: 1024px) { .col-span-8, .col-span-6, .col-span-4 { grid-column: span 12; } }
        @media (max-width: 768px) {
            .sidebar { position: fixed; top: 0; right: 0; height: 100vh; width: 280px; transform: translateX(100%); box-shadow: -10px 0 30px rgba(0,0,0,0.5); z-index: 1001; margin-top: 0; padding-top: 80px; }
            .sidebar.open { transform: translateX(0); }
            .toggle-btn { display: block; z-index: 1002; }
            .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(3px); z-index: 1000; opacity: 0; pointer-events: none; transition: 0.3s; }
            .overlay.active { opacity: 1; pointer-events: auto; }
            .main-content { padding: 20px 15px; }
            .brand { display: none; }
            .card { padding: 20px; }
        }
        /* Toast */
        #toast-container { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; }
        .toast { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); color: white; padding: 12px 24px; border-radius: 30px; margin-top: 10px; border: 1px solid var(--glass-border); display: flex; align-items: center; gap: 10px; animation: slideUp 0.3s; }
        .toast.success i { color: var(--success); } .toast.error i { color: var(--danger); }
    </style>
</head>
<body>
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
    <header class="top-bar">
        <div style="display:flex; align-items:center; gap:15px;">
            <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            <div class="greeting" id="greetingText">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</div>
        </div>
        <div class="clock-area">
            <div class="date-display" id="dateDisplay">...</div>
            <div class="time-display" id="timeDisplay">00:00</div>
        </div>
    </header>

    <div class="sidebar" id="sidebar">
        <div class="brand"><i class="fas fa-crown"></i> KINGS TECH <span>v10.5 Complete</span></div>
        
        <div class="nav-section">Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙŠÙˆÙ…ÙŠ</div>
        <button class="nav-btn active" onclick="navTo('dashboard')"><i class="fas fa-th-large"></i> Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="nav-btn" onclick="navTo('goal_tomorrow')"><i class="fas fa-moon"></i> Ù…Ù‡Ø§Ù… Ø§Ù„ØºØ¯</button>
        
        <div class="nav-section">Ø§Ù„ØªØ®Ø·ÙŠØ·</div>
        <button class="nav-btn" onclick="navTo('goal_yearly')"><i class="fas fa-star"></i> Ø£Ù‡Ø¯Ø§Ù 2026</button>
        <button class="nav-btn" onclick="navTo('goal_quarterly')"><i class="fas fa-calendar-alt"></i> Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø±Ø¨Ø¹</button>
        <button class="nav-btn" onclick="navTo('goal_monthly')"><i class="fas fa-calendar-day"></i> Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø´Ù‡Ø±</button>
        <button class="nav-btn" onclick="navTo('goal_weekly')"><i class="fas fa-calendar-week"></i> Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
        <button class="nav-btn" onclick="navTo('habits')"><i class="fas fa-check-double"></i> Ø§Ù„Ø¹Ø§Ø¯Ø§Øª</button>

        <div class="nav-section">Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®</div>
        <button class="nav-btn" onclick="navTo('best_days')"><i class="fas fa-trophy"></i> Ø£ÙØ¶Ù„ 10 Ø£ÙŠØ§Ù… (AI)</button>
        <button class="nav-btn" onclick="navTo('history_logs')"><i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</button>
        <button class="nav-btn" onclick="navTo('projects')"><i class="fas fa-project-diagram"></i> Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</button>
        
        <div class="nav-section">Ø§Ù„Ø±ÙˆØ­Ø§Ù†ÙŠØ§Øª</div>
        <button class="nav-btn" onclick="navTo('spirituality')"><i class="fas fa-kaaba"></i> Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø© ÙˆØ§Ù„Ù…Ø³Ø¨Ø­Ø©</button>
        <button class="nav-btn" onclick="navTo('adhkar')"><i class="fas fa-hands-praying"></i> Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù…</button>

        <div style="flex:1"></div>
        <div style="padding: 0 10px; margin-top: 20px; border-top: 1px solid var(--glass-border); padding-top: 20px;">
            <button class="nav-btn" onclick="exportData()" style="color:var(--success); font-size:0.85rem"><i class="fas fa-download"></i> Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</button>
            <button class="nav-btn" onclick="clearData()" style="color:var(--danger); font-size:0.85rem"><i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
    </div>

    <div class="main-content">
        
        <!-- Dashboard -->
        <div id="dashboard" class="page active">
            <h2><i class="fas fa-th-large"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</h2>
            <div class="dashboard-grid">
                <!-- Quote -->
                <div class="card col-span-12 quote-card">
                    <i class="fas fa-quote-right" style="font-size:2rem; opacity:0.2; margin-bottom:10px;"></i>
                    <div class="quote-text" id="dailyQuote">"Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙŠØ³ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŒ ÙˆØ§Ù„ÙØ´Ù„ Ù„ÙŠØ³ Ù‚Ø§ØªÙ„Ø§Ù‹: Ø§Ù„Ø´Ø¬Ø§Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù‡ÙŠ Ù…Ø§ ÙŠÙ‡Ù…."</div>
                    <div style="font-size:0.8rem; color:var(--accent); font-weight:bold;">Ø§Ù‚ØªØ¨Ø§Ø³ Ø§Ù„ÙŠÙˆÙ…</div>
                </div>

                <div class="card col-span-12" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(15, 23, 42, 0.8));">
                    <div class="card-header">
                        <span>â­ ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ 2026</span>
                        <span class="edit-link" onclick="navTo('goal_yearly')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</span>
                    </div>
                    <div style="margin-bottom:10px; font-size:2rem; font-weight:900; color:var(--primary);" id="yearlyProgressText">0%</div>
                    <div class="progress-container" style="width:100%; background:rgba(255,255,255,0.1); height:8px; border-radius:4px; margin-top:10px;">
                        <div class="progress-bar" id="yearlyProgressBar" style="height:100%; background:var(--success); width:0%; transition:width 0.5s;"></div>
                    </div>
                    <div style="margin-top:10px; display:flex; justify-content:space-between; font-size:0.8rem; color:#94a3b8;">
                        <span id="yearlyDoneCount">0 Ù…ÙƒØªÙ…Ù„</span>
                        <span id="yearlyTotalCount">0 Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                    </div>
                </div>
                <div class="card col-span-6">
                    <div class="card-header"><span>ğŸ“… Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø´Ù‡Ø±</span> <span class="edit-link" onclick="navTo('goal_monthly')">ØªØ¹Ø¯ÙŠÙ„</span></div>
                    <ul id="list_dash_monthly" class="read-only-list"></ul>
                </div>
                <div class="card col-span-6">
                    <div class="card-header"><span>âš¡ Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</span> <span class="edit-link" onclick="navTo('goal_weekly')">ØªØ¹Ø¯ÙŠÙ„</span></div>
                    <ul id="list_dash_weekly" class="read-only-list"></ul>
                </div>
                <div class="card col-span-4">
                    <div class="card-header"><span>ğŸ“Š Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø±Ø¨Ø¹</span> <span class="edit-link" onclick="navTo('goal_quarterly')">ØªØ¹Ø¯ÙŠÙ„</span></div>
                    <ul id="list_dash_quarterly" class="read-only-list"></ul>
                </div>
                <div class="card col-span-8">
                    <div class="card-header"><span>âœ… Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</span> <span class="edit-link" onclick="navTo('habits')">ØªØ¹Ø¯ÙŠÙ„</span></div>
                    <ul id="list_dash_habits" class="read-only-list"></ul>
                </div>
            </div>
        </div>

        <!-- NEW: Goal Tomorrow (Cycle) -->
        <div id="goal_tomorrow" class="page">
            <h2><i class="fas fa-moon"></i> Ù…Ù‡Ø§Ù… Ø§Ù„ØºØ¯</h2>
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:20px;">
                <!-- Planner -->
                <div class="card">
                    <div class="card-header">ğŸ“ Ø®Ø·Ø© Ø§Ù„ØºØ¯</div>
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <input type="text" id="in_tomorrow" placeholder="Ù…Ø§Ø°Ø§ Ø³ØªÙ†Ø¬Ø² ØºØ¯Ø§Ù‹ØŸ" style="margin:0;">
                        <button class="btn" onclick="addItem('tomorrow', 'in_tomorrow')">Ø¥Ø¶Ø§ÙØ©</button>
                    </div>
                    <ul id="list_tomorrow"></ul>
                </div>
                
                <!-- Today's Achievements -->
                <div class="card" style="border-color:var(--success)">
                    <div class="card-header" style="color:var(--success)">ğŸ† Ù…Ø§ ØªÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</div>
                    <ul id="list_today_done" style="opacity:0.8"></ul>
                </div>
            </div>

            <!-- Accumulated Section -->
            <div class="card col-span-12" style="margin-top:20px; border-color:var(--danger);">
                <div class="card-header" style="color:var(--danger); display:flex; justify-content:space-between;">
                    <span>â›” Ù…Ù‡Ø§Ù… Ù…ØªØ±Ø§ÙƒÙ…Ø© (Backlog)</span>
                    <button class="btn btn-danger" onclick="processDay()">ğŸŒ™ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… (Ù†Ù‚Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ù…ØªØ±Ø§ÙƒÙ…)</button>
                </div>
                <p style="font-size:0.85rem; color:#94a3b8; margin-bottom:10px;">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙŠ Ù„Ù… ØªÙƒØªÙ…Ù„ Ù…Ù† Ø§Ù„ØºØ¯ Ø³ØªÙ†Ù‚Ù„ Ù‡Ù†Ø§ Ø¹Ù†Ø¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ….</p>
                <ul id="list_accumulated"></ul>
            </div>
        </div>

        <!-- Goals Pages (Standard) -->
        <div id="goal_yearly" class="page">
            <h2><i class="fas fa-star"></i> ØªØ®Ø·ÙŠØ· 2026</h2>
            <div class="card">
                <div class="card-header">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ÙƒØ¨Ø±Ù‰</div>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="in_page_yearly" placeholder="Ø£Ø¶Ù Ù‡Ø¯ÙØ§Ù‹ Ø³Ù†ÙˆÙŠØ§Ù‹..." style="margin:0;">
                    <button class="btn" onclick="addItem('yearly', 'in_page_yearly')">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <ul id="list_page_yearly"></ul>
            </div>
        </div>

        <div id="goal_quarterly" class="page">
            <h2><i class="fas fa-calendar-alt"></i> ØªØ®Ø·ÙŠØ· Ø§Ù„Ø±Ø¨Ø¹</h2>
            <div class="card">
                <div class="card-header">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù€ 90 ÙŠÙˆÙ…</div>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="in_page_quarterly" placeholder="Ø£Ø¶Ù Ù‡Ø¯ÙØ§Ù‹..." style="margin:0;">
                    <button class="btn" onclick="addItem('quarterly', 'in_page_quarterly')">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <ul id="list_page_quarterly"></ul>
            </div>
        </div>

        <div id="goal_monthly" class="page">
            <h2><i class="fas fa-calendar-day"></i> ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ù‡Ø±</h2>
            <div class="card">
                <div class="card-header">Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±</div>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="in_page_monthly" placeholder="Ø£Ø¶Ù Ù‡Ø¯ÙØ§Ù‹ Ø´Ù‡Ø±ÙŠØ§Ù‹..." style="margin:0;">
                    <button class="btn" onclick="addItem('monthly', 'in_page_monthly')">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <ul id="list_page_monthly"></ul>
            </div>
        </div>

        <div id="goal_weekly" class="page">
            <h2><i class="fas fa-calendar-week"></i> ØªØ®Ø·ÙŠØ· Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h2>
            <div class="card">
                <div class="card-header">Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="in_page_weekly" placeholder="Ø£Ø¶Ù Ù…Ù‡Ù…Ø©..." style="margin:0;">
                    <button class="btn" onclick="addItem('weekly', 'in_page_weekly')">Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <ul id="list_page_weekly"></ul>
            </div>
        </div>

        <div id="habits" class="page">
            <h2><i class="fas fa-check-double"></i> Ø§Ù„Ø¹Ø§Ø¯Ø§Øª</h2>
            <div class="grid-container">
                <div class="card">
                    <div class="card-header">ğŸŸ¢ Ø¹Ø§Ø¯Ø§Øª Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</div>
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <input type="text" id="in_page_habits" placeholder="Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©..." style="margin:0;">
                        <button class="btn" onclick="addItem('habits', 'in_page_habits')">Ø¥Ø¶Ø§ÙØ©</button>
                    </div>
                    <ul id="list_page_habits"></ul>
                </div>
                <div class="card" style="border-color:var(--danger)">
                    <div class="card-header" style="color:var(--danger)">ğŸ”´ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙˆÙ‚Ù</div>
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <input type="text" id="in_stop" placeholder="Ø³Ø£ØªÙˆÙ‚Ù Ø¹Ù†..." style="margin:0;">
                        <button class="btn btn-danger" onclick="addItem('stopList', 'in_stop')">Ø­Ø¸Ø±</button>
                    </div>
                    <ul id="list_stop"></ul>
                </div>
            </div>
        </div>

        <!-- NEW: Best 10 Days WITH AI -->
        <div id="best_days" class="page">
            <h2><i class="fas fa-trophy"></i> Ø£ÙØ¶Ù„ 10 Ø£ÙŠØ§Ù… (Smart AI)</h2>
            <div class="grid-container">
                <div class="card" style="border-color:var(--accent)">
                    <div class="card-header">Ø³Ø¬Ù„ ÙŠÙˆÙ… Ø±Ø§Ø¦Ø¹</div>
                    <p style="font-size:0.85rem; color:#94a3b8; margin-bottom:10px;">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªØ­Ù„ÙŠÙ„ Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ….</p>
                    
                    <!-- AI Button -->
                    <button class="btn btn-ai" onclick="analyzeDayAI()" style="margin-bottom:15px;">
                        <i class="fas fa-brain"></i> ØªØ­Ù„ÙŠÙ„ ÙŠÙˆÙ…ÙŠ Ø°ÙƒÙŠ (Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ù† Ø§Ù„Ù…Ù‡Ø§Ù…)
                    </button>

                    <input type="date" id="day_date">
                    <textarea id="day_desc" placeholder="ÙˆØµÙ Ø§Ù„ÙŠÙˆÙ… (Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ)" rows="4" style="resize:none;"></textarea>
                    <input type="number" id="day_rate" placeholder="Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (1-10)" max="10" min="1">
                    <button class="btn btn-warning" onclick="addBestDay()">Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…</button>
                </div>
                <div class="card col-span-2" id="best_days_list_container" style="grid-column: span 2; display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:15px;"></div>
            </div>
        </div>

        <!-- NEW: History Logs -->
        <div id="history_logs" class="page">
            <h2><i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„</h2>
            <div class="dashboard-grid">
                <div class="card col-span-4">
                    <div class="card-header">ğŸ“… Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø´Ù‡Ø±</div>
                    <ul id="log_monthly" class="read-only-list"></ul>
                </div>
                <div class="card col-span-4">
                    <div class="card-header">ğŸ“Š Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø±Ø¨Ø¹</div>
                    <ul id="log_quarterly" class="read-only-list"></ul>
                </div>
                <div class="card col-span-4">
                    <div class="card-header">â­ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø³Ù†Ø©</div>
                    <ul id="log_yearly" class="read-only-list"></ul>
                </div>
            </div>
        </div>
        
        <div id="projects" class="page">
            <h2><i class="fas fa-project-diagram"></i> Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h2>
            <div style="display:flex; gap:20px; overflow-x:auto; padding-bottom:10px;">
                <div style="flex:1; min-width:280px; background:rgba(255,255,255,0.02); padding:15px; border-radius:12px; border:1px solid var(--glass-border);"><h3 style="margin-bottom:15px; color:#94a3b8;">ğŸ“‹ Ø£ÙÙƒØ§Ø±</h3><div id="kb_todo"></div><input id="kb_in" onkeypress="if(event.key=='Enter') addKB()" placeholder="+ Ù…Ø´Ø±ÙˆØ¹" style="margin-top:15px;"></div>
                <div style="flex:1; min-width:280px; background:rgba(59,130,246,0.05); padding:15px; border-radius:12px; border:1px solid rgba(59,130,246,0.2);"><h3 style="margin-bottom:15px; color:var(--primary);">ğŸ”¥ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</h3><div id="kb_doing"></div></div>
                <div style="flex:1; min-width:280px; background:rgba(16,185,129,0.05); padding:15px; border-radius:12px; border:1px solid rgba(16,185,129,0.2);"><h3 style="margin-bottom:15px; color:var(--success);">âœ… ØªÙ…</h3><div id="kb_done"></div></div>
            </div>
        </div>

        <!-- Spirituality -->
        <div id="spirituality" class="page">
            <h2><i class="fas fa-kaaba"></i> Ø§Ù„Ø¹Ø¨Ø§Ø¯Ø© ÙˆØ§Ù„ØªØ±ÙƒÙŠØ²</h2>
            <div class="grid-container">
                <div class="card"><div class="card-header">ğŸ“– Ø§Ù„Ù‚Ø±Ø¢Ù†</div><div style="text-align:center;"><input type="number" id="quranPage" onchange="saveData(this.value)" style="font-size:2rem; text-align:center; width:140px; border-color:var(--primary);" placeholder="0"></div></div>
                <div class="card"><div class="card-header">ğŸ… Ù…Ø¤Ù‚Øª</div><div id="pomodoroTimer" style="font-size:3rem; text-align:center; font-weight:900;">25:00</div><div style="display:flex; justify-content:center; gap:10px;"><button class="btn" onclick="togglePomodoro()">Ø¨Ø¯Ø¡</button><button class="btn btn-outline" onclick="resetPomodoro()">Ø¥Ø¹Ø§Ø¯Ø©</button></div></div>
                <div class="card" style="text-align:center;"><div class="card-header" style="justify-content:center">ğŸ“¿ Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</div><div style="font-size:3.5rem; font-weight:bold; color:var(--accent); cursor:pointer; border:4px solid rgba(255,255,255,0.05); border-radius:50%; width:160px; height:160px; line-height:150px; margin:0 auto;" onclick="incMasbaha()" id="dhikrNum">0</div><button class="btn" onclick="saveXP()" style="margin-top:15px;">Ø­ÙØ¸</button></div>
                <div class="card"><div class="card-header">ğŸ•Œ Ø§Ù„ØµÙ„ÙˆØ§Øª</div><div id="salahContainer"></div></div>
            </div>
        </div>

        <!-- NEW: Adhkar Page (COMPLETE) -->
        <div id="adhkar" class="page">
            <h2><i class="fas fa-hands-praying"></i> Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù… (Ø§Ù„ÙƒØ§Ù…Ù„)</h2>
            <div style="display:flex; gap:10px; margin-bottom:25px; flex-wrap:wrap;">
                <button class="btn" onclick="renderAdhkar('morning')">ğŸŒ… Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</button>
                <button class="btn" style="background:var(--accent); color:black;" onclick="renderAdhkar('evening')">ğŸŒ‡ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</button>
                <button class="btn" style="background:#4f46e5" onclick="renderAdhkar('sleep')">ğŸ’¤ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</button>
            </div>
            <div id="adhkarContainer" class="adhkar-container"></div>
        </div>
    </div>
    <div id="toast-container"></div>

    <script>
    // --- SAFE DOM ACCESS HELPERS ---
    const $ = (id) => document.getElementById(id);
    const setText = (id, txt) => { const el = $(id); if(el) el.innerText = txt; };
    const setVal = (id, val) => { const el = $(id); if(el) el.value = val; };
    const setHtml = (id, html) => { const el = $(id); if(el) el.innerHTML = html; };

    // --- CORE VARIABLES ---
    const STORAGE_KEY = 'kingsTechOS_v10_5_full';
    
    const quotes = [
        "Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙŠØ³ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŒ ÙˆØ§Ù„ÙØ´Ù„ Ù„ÙŠØ³ Ù‚Ø§ØªÙ„Ø§Ù‹: Ø§Ù„Ø´Ø¬Ø§Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù‡ÙŠ Ù…Ø§ ÙŠÙ‡Ù….",
        "Ù„Ø§ ØªÙ‚Ø§Ø±Ù† Ø¨Ø¯Ø§ÙŠØªÙƒ Ø¨Ù…Ù†ØªØµÙ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.",
        "Ø§Ù„Ù†Ø§Ø¬Ø­ÙˆÙ† ÙŠØ¨Ø­Ø«ÙˆÙ† Ø¹Ù† Ø§Ù„ÙØ±ØµØŒ ÙˆØ§Ù„ÙØ§Ø´Ù„ÙˆÙ† ÙŠØ¨Ø­Ø«ÙˆÙ† Ø¹Ù† Ø§Ù„Ø£Ø¹Ø°Ø§Ø±.",
        "ÙƒÙ„ Ø¥Ù†Ø¬Ø§Ø² Ø¹Ø¸ÙŠÙ… Ø¨Ø¯Ø£ Ø¨Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.",
        "Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…Ù„Ùƒ Ù„Ø£ÙˆÙ„Ø¦Ùƒ Ø§Ù„Ø°ÙŠÙ† ÙŠØ¤Ù…Ù†ÙˆÙ† Ø¨Ø¬Ù…Ø§Ù„ Ø£Ø­Ù„Ø§Ù…Ù‡Ù…."
    ];

    const defaultData = {
        yearly: [], quarterly: [], monthly: [], weekly: [], habits: [], stopList: [],
        tomorrow: [], todayDone: [], accumulated: [],
        bestDays: [],
        adhkarProgress: { morning: {}, evening: {}, sleep: {} },
        salah: { fajr: false, dhuhr: false, asr: false, maghrib: false, isha: false },
        kanban: { todo: [], doing: [], done: [] },
        quranPage: 0, xp: 0
    };

    let data = { ...defaultData };

    // --- INITIALIZATION ---
    function loadData() {
        try {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                const parsed = JSON.parse(stored);
                for (let key in defaultData) {
                    if (parsed[key] !== undefined) {
                        data[key] = parsed[key];
                    }
                }
            }
        } catch (e) {
            console.error("Data corrupted, resetting...");
            data = { ...defaultData };
        }
        saveData();
    }

    function saveData() {
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        } catch (e) {
            showToast("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸!", "error");
        }
    }

    // --- MAIN LOOP ---
    document.addEventListener('DOMContentLoaded', () => {
        loadData();
        refreshAll();
        startClock();
        renderBestDays();
        renderHistoryLogs();
        
        const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
        setText('dailyQuote', `"${randomQuote}"`);
    });

    // --- RENDERING FUNCTIONS ---
    function refreshAll() {
        renderList('yearly', 'list_dash_yearly', false);
        renderList('monthly', 'list_dash_monthly', false);
        renderList('weekly', 'list_dash_weekly', false);
        renderList('quarterly', 'list_dash_quarterly', false);
        renderList('habits', 'list_dash_habits', false);

        renderList('yearly', 'list_page_yearly', true);
        renderList('monthly', 'list_page_monthly', true);
        renderList('weekly', 'list_page_weekly', true);
        renderList('quarterly', 'list_page_quarterly', true);
        renderList('habits', 'list_page_habits', true);
        renderList('stopList', 'list_stop', true);

        renderTomorrowList();
        renderList('todayDone', 'list_today_done', false);
        renderAccumulatedList();

        updateProgressBars();
        setVal('quranPage', data.quranPage || 0);
        renderKanban();
        renderSalah();
    }

    function renderList(key, elementId, allowDelete) {
        const list = $(elementId);
        if (!list) return;
        list.innerHTML = "";
        
        if (!Array.isArray(data[key])) data[key] = [];

        data[key].forEach((item, idx) => {
            const li = document.createElement('li');
            if (item.checked) li.classList.add('checked');
            
            let delHtml = '';
            if (allowDelete) {
                delHtml = `<i class="fas fa-trash" onclick="deleteItem('${key}', ${idx})" style="color:var(--danger); cursor:pointer;"></i>`;
            }

            li.innerHTML = `
                <div onclick="toggleCheck('${key}', ${idx})" style="cursor:pointer; flex:1; display:flex; align-items:center; gap:10px;">
                    <i class="fas ${item.checked ? 'fa-check-circle' : 'fa-circle'}" style="color:${item.checked?'var(--success)':'#475569'}"></i>
                    <span>${item.text}</span>
                </div>
                ${delHtml}
            `;
            list.appendChild(li);
        });
    }

    function addItem(key, inputId) {
        const input = $(inputId);
        if (!input || !input.value.trim()) {
            showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø´ÙŠØ¡ Ù…Ø§', 'error');
            return;
        }
        if (!Array.isArray(data[key])) data[key] = [];

        data[key].push({ text: input.value, checked: false });
        input.value = "";
        saveData();
        refreshAll();
        showToast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©', 'success');
    }

    function toggleCheck(key, idx) {
        if (!data[key] || !data[key][idx]) return;
        data[key][idx].checked = !data[key][idx].checked;
        saveData();
        refreshAll();
        renderHistoryLogs();
    }

    function deleteItem(key, idx) {
        if (!data[key]) return;
        data[key].splice(idx, 1);
        saveData();
        refreshAll();
    }

    // --- TOMORROW LOGIC ---
    function renderTomorrowList() {
        const list = $('list_tomorrow');
        if (!list) return;
        list.innerHTML = "";
        if (!Array.isArray(data.tomorrow)) data.tomorrow = [];

        data.tomorrow.forEach((item, idx) => {
            const li = document.createElement('li');
            li.innerHTML = `
                <span>${item.text}</span>
                <div class="task-actions">
                    <button class="action-btn done-btn" onclick="completeTomorrow(${idx})"><i class="fas fa-check"></i> ØªÙ…</button>
                    <button class="action-btn" style="background:var(--danger); color:white;" onclick="deleteItem('tomorrow', ${idx})"><i class="fas fa-times"></i></button>
                </div>
            `;
            list.appendChild(li);
        });
    }

    function completeTomorrow(idx) {
        if (!Array.isArray(data.tomorrow) || !data.tomorrow[idx]) return;
        const task = data.tomorrow.splice(idx, 1)[0];
        if (!Array.isArray(data.todayDone)) data.todayDone = [];
        data.todayDone.push(task);
        saveData();
        refreshAll();
        showToast('Ù†Ù‚Ù„ Ù„Ù…Ø§ ØªÙ… Ø§Ù„ÙŠÙˆÙ…', 'success');
    }

    function processDay() {
        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…ØŸ Ø³ÙŠØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… ØºÙŠØ± Ø§Ù„Ù…Ù†Ø¬Ø²Ø© Ø¥Ù„Ù‰ "Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©" ÙˆØªØµÙÙŠØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØºØ¯.')) {
            if (!Array.isArray(data.accumulated)) data.accumulated = [];
            if (!Array.isArray(data.tomorrow)) data.tomorrow = [];
            
            data.accumulated = [...data.accumulated, ...data.tomorrow];
            data.tomorrow = [];
            saveData();
            refreshAll();
            showToast('ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
    }

    function renderAccumulatedList() {
        const list = $('list_accumulated');
        if (!list) return;
        list.innerHTML = "";
        if (!Array.isArray(data.accumulated)) data.accumulated = [];

        data.accumulated.forEach((item, idx) => {
            const li = document.createElement('li');
            li.className = 'accumulated-item';
            li.innerHTML = `
                <span style="color:#94a3b8">${item.text}</span>
                <div class="task-actions">
                    <button class="action-btn done-btn" onclick="restoreAccumulated(${idx})">Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù„ØºØ¯</button>
                    <button class="action-btn" style="background:var(--danger); color:white;" onclick="deleteItem('accumulated', ${idx})">Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ</button>
                </div>
            `;
            list.appendChild(li);
        });
    }

    function restoreAccumulated(idx) {
        if (!Array.isArray(data.accumulated) || !data.accumulated[idx]) return;
        const task = data.accumulated.splice(idx, 1)[0];
        if (!Array.isArray(data.tomorrow)) data.tomorrow = [];
        data.tomorrow.push(task);
        saveData();
        refreshAll();
    }

    // --- AI BEST DAYS LOGIC ---
    function analyzeDayAI() {
        if (!Array.isArray(data.todayDone) || data.todayDone.length === 0) {
            $('day_desc').value = "Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… Ø¨Ø¹Ø¯. Ø³ÙŠØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø².";
            $('day_rate').value = 1;
            showToast("Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø¬Ø§Ø² Ù…Ù‡Ø§Ù… Ù„Ù„ØªØ­Ù„ÙŠÙ„", "error");
            return;
        }

        const completedTasks = data.todayDone.map(t => t.text);
        const count = completedTasks.length;
        
        let desc = `ÙŠÙˆÙ… Ø¥Ù†ØªØ§Ø¬ÙŠ! ØªÙ… Ø¥Ù†Ø¬Ø§Ø² ${count} Ù…Ù‡Ø§Ù… Ø±Ø¦ÙŠØ³ÙŠØ©:\n`;
        completedTasks.forEach(task => {
            desc += `- ${task}\n`;
        });
        
        let rating = 5;
        if (count > 2) rating = 7;
        if (count > 5) rating = 9;
        if (count > 8) rating = 10;

        $('day_desc').value = desc;
        $('day_rate').value = rating;
        showToast("ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ÙŠÙˆÙ…", "success");
    }

    function addBestDay() {
        const dateEl = $('day_date');
        const descEl = $('day_desc');
        const rateEl = $('day_rate');
        
        const date = dateEl ? dateEl.value : '';
        const desc = descEl ? descEl.value : '';
        const rate = rateEl ? parseInt(rateEl.value) : 0;

        if (!date || !desc || !rate) {
            showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            return;
        }
        if (!Array.isArray(data.bestDays)) data.bestDays = [];

        data.bestDays.push({ date, desc, rate });
        data.bestDays.sort((a, b) => b.rate - a.rate);
        
        if (data.bestDays.length > 10) data.bestDays = data.bestDays.slice(0, 10);

        saveData();
        renderBestDays();
        showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…', 'success');
        if (descEl) descEl.value = "";
    }

    function renderBestDays() {
        const container = $('best_days_list_container');
        if (!container) return;
        container.innerHTML = "";
        if (!Array.isArray(data.bestDays)) data.bestDays = [];

        data.bestDays.forEach((day, i) => {
            const div = document.createElement('div');
            div.className = "card best-day-card";
            div.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span class="rank-badge">${day.rate}/10</span>
                    <i class="fas fa-medal" style="color:${i===0?'#FFD700':(i===1?'#C0C0C0':'#CD7F32')}; font-size:1.5rem;"></i>
                </div>
                <h4 style="margin:10px 0; color:white;">${day.date}</h4>
                <p style="font-size:0.9rem; color:#cbd5e1; white-space: pre-wrap;">${day.desc}</p>
            `;
            container.appendChild(div);
        });
    }

    // --- ADHKAR LOGIC (FULL DATABASE) ---
    const adhkarDB = {
        morning: [
            {t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1},
            {t:"Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙÙ„ÙÙ…ÙØ§ØªÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„ØªÙ‘ÙØ§Ù…Ù‘ÙØ§ØªÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ù„Ø§Ù ÙŠÙØ¶ÙØ±Ù‘Ù Ù…ÙØ¹Ù Ø§Ø³Ù’Ù…ÙÙ‡Ù Ø´ÙÙŠÙ’Ø¡ÙŒ ÙÙÙŠ Ø§Ù„Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„Ø§Ù ÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§Ø¡Ù ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ø³Ù‘ÙÙ…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø£ÙØµÙ’Ø¨ÙØ­Ù’Ù†ÙØ§ ÙˆÙØ£ÙØµÙ’Ø¨ÙØ­Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„Ù‘ÙÙ‡ÙØŒ ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡ÙØŒ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰ ÙƒÙÙ„Ù‘Ù Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø®ÙÙŠÙ’Ø±Ù Ù…ÙØ§ ÙÙÙŠ Ù‡ÙØ°ÙØ§ Ø§Ù„Ù’ÙŠÙÙˆÙ’Ù…Ù ÙˆÙØ®ÙÙŠÙ’Ø±Ù Ù…ÙØ§ Ø¨ÙØ¹Ù’Ø¯ÙÙ‡ÙØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ ÙÙÙŠ Ù‡ÙØ°ÙØ§ Ø§Ù„Ù’ÙŠÙÙˆÙ’Ù…Ù ÙˆÙØ´ÙØ±Ù‘Ù Ù…ÙØ§ Ø¨ÙØ¹Ù’Ø¯ÙÙ‡ÙØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙƒÙØ³ÙÙ„Ù ÙˆÙØ³ÙÙˆØ¡Ù Ø§Ù„Ù’ÙƒÙØ¨ÙØ±ÙØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø¹ÙØ°ÙØ§Ø¨Ù ÙÙÙŠ Ø§Ù„Ù†Ù‘ÙØ§Ø±Ù ÙˆÙØ¹ÙØ°ÙØ§Ø¨Ù ÙÙÙŠ Ø§Ù„Ù’Ù‚ÙØ¨Ù’Ø±Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¨ÙÙƒÙ Ø£ÙØµÙ’Ø¨ÙØ­Ù’Ù†ÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ø£ÙÙ…Ù’Ø³ÙÙŠÙ’Ù†ÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ù†ÙØ­Ù’ÙŠÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ù†ÙÙ…ÙÙˆØªÙ ÙˆÙØ¥ÙÙ„ÙÙŠÙ’ÙƒÙ Ø§Ù„Ù†Ù‘ÙØ´ÙÙˆØ±Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø£ÙÙ†Ù’ØªÙ Ø±ÙØ¨Ù‘ÙÙŠ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙØŒ Ø®ÙÙ„ÙÙ‚Ù’ØªÙÙ†ÙÙŠ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙØ¨Ù’Ø¯ÙÙƒÙØŒ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ø¹ÙÙ‡Ù’Ø¯ÙÙƒÙ ÙˆÙÙˆÙØ¹Ù’Ø¯ÙÙƒÙ Ù…ÙØ§ Ø§Ø³Ù’ØªÙØ·ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ ØµÙÙ†ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙÙ†ÙØ¹Ù’Ù…ÙØªÙÙƒÙ Ø¹ÙÙ„ÙÙŠÙ‘ÙØŒ ÙˆÙØ£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙØ°ÙÙ†Ù’Ø¨ÙÙŠ ÙÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙÙØ¥ÙÙ†Ù‘ÙÙ‡Ù Ù„Ø§Ù ÙŠÙØºÙ’ÙÙØ±Ù Ø§Ù„Ø°Ù‘ÙÙ†ÙÙˆØ¨Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙ.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØµÙ’Ø¨ÙØ­Ù’ØªÙ Ø£ÙØ´Ù’Ù‡ÙØ¯ÙÙƒÙØŒ ÙˆÙØ£ÙØ´Ù’Ù‡ÙØ¯Ù Ø­ÙÙ…ÙÙ„ÙØ©Ù Ø¹ÙØ±Ù’Ø´ÙÙƒÙØŒ ÙˆÙÙ…ÙÙ„Ø§ÙØ¦ÙÙƒÙØªÙÙƒÙØŒ ÙˆÙØ¬ÙÙ…ÙÙŠØ¹Ù Ø®ÙÙ„Ù’Ù‚ÙÙƒÙØŒ Ø£ÙÙ†Ù‘ÙÙƒÙ Ø£ÙÙ†Ù’ØªÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙ ÙˆÙØ­Ù’Ø¯ÙÙƒÙ Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙƒÙØŒ ÙˆÙØ£ÙÙ†Ù‘Ù Ù…ÙØ­ÙÙ…Ù‘ÙØ¯Ø§Ù‹ Ø¹ÙØ¨Ù’Ø¯ÙÙƒÙ ÙˆÙØ±ÙØ³ÙÙˆÙ„ÙÙƒÙ (4 Ù…Ø±Ø§Øª)", c:4},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ù…ÙØ§ Ø£ÙØµÙ’Ø¨ÙØ­Ù Ø¨ÙÙŠ Ù…ÙÙ†Ù’ Ù†ÙØ¹Ù’Ù…ÙØ©Ù Ø£ÙÙˆÙ’ Ø¨ÙØ£ÙØ­ÙØ¯Ù Ù…ÙÙ†Ù’ Ø®ÙÙ„Ù’Ù‚ÙÙƒÙ ÙÙÙ…ÙÙ†Ù’ÙƒÙ ÙˆÙØ­Ù’Ø¯ÙÙƒÙ Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙƒÙØŒ ÙÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ„ÙÙƒÙ Ø§Ù„Ø´Ù‘ÙÙƒÙ’Ø±Ù.", c:1},
            {t:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù (100 Ù…Ø±Ø©)", c:100},
            {t:"Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰ ÙƒÙÙ„Ù‘Ù Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ (100 Ù…Ø±Ø©)", c:100},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø¹ÙØ§ÙÙÙŠÙØ©Ù ÙÙÙŠ Ø§Ù„Ø¯Ù‘ÙÙ†Ù’ÙŠÙØ§ ÙˆÙØ§Ù„Ø¢Ø®ÙØ±ÙØ©ÙØŒ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙˆÙØ§Ù„Ù’Ø¹ÙØ§ÙÙÙŠÙØ©Ù ÙÙÙŠ Ø¯ÙÙŠÙ†ÙÙŠ ÙˆÙØ¯ÙÙ†Ù’ÙŠÙØ§ÙŠÙ ÙˆÙØ£ÙÙ‡Ù’Ù„ÙÙŠ ÙˆÙÙ…ÙØ§Ù„ÙÙŠØŒ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø§Ø³Ù’ØªÙØ±Ù’ Ø¹ÙÙˆÙ’Ø±ÙØ§ØªÙÙŠ ÙˆÙØ¢Ù…ÙÙ†Ù’ Ø±ÙÙˆÙ’Ø¹ÙØ§ØªÙÙŠØŒ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø§Ø­Ù’ÙÙØ¸Ù’Ù†ÙÙŠ Ù…ÙÙ†Ù’ Ø¨ÙÙŠÙ’Ù†Ù ÙŠÙØ¯ÙÙŠÙ‘Ù ÙˆÙÙ…ÙÙ†Ù’ Ø®ÙÙ„Ù’ÙÙÙŠØŒ ÙˆÙØ¹ÙÙ†Ù’ ÙŠÙÙ…ÙÙŠÙ†ÙÙŠ ÙˆÙØ¹ÙÙ†Ù’ Ø´ÙÙ…ÙØ§Ù„ÙÙŠØŒ ÙˆÙÙ…ÙÙ†Ù’ ÙÙÙˆÙ’Ù‚ÙÙŠØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ¹ÙØ¸ÙÙ…ÙØªÙÙƒÙ Ø£ÙÙ†Ù’ Ø£ÙØºÙ’ØªÙØ§Ù„Ù Ù…ÙÙ†Ù’ ØªÙØ­Ù’ØªÙÙŠ.", c:1},
            {t:"Ø±ÙØ¶ÙÙŠØªÙ Ø¨ÙØ§Ù„Ù„Ù‘ÙÙ‡Ù Ø±ÙØ¨Ù‘ÙØ§Ù‹ØŒ ÙˆÙØ¨ÙØ§Ù„Ø¥ÙØ³Ù’Ù„Ø§ÙÙ…Ù Ø¯ÙÙŠÙ†Ø§Ù‹ØŒ ÙˆÙØ¨ÙÙ…ÙØ­ÙÙ…Ù‘ÙØ¯Ù ØµÙÙ„Ù‘ÙÙ‰ Ø§Ù„Ù„Ù‡Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡Ù ÙˆÙØ³ÙÙ„Ù‘ÙÙ…Ù Ù†ÙØ¨ÙÙŠÙ‘ÙØ§Ù‹ (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¹ÙØ§ÙÙÙ†ÙÙŠ ÙÙÙŠ Ø¨ÙØ¯ÙÙ†ÙÙŠØŒ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¹ÙØ§ÙÙÙ†ÙÙŠ ÙÙÙŠ Ø³ÙÙ…Ù’Ø¹ÙÙŠØŒ Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¹ÙØ§ÙÙÙ†ÙÙŠ ÙÙÙŠ Ø¨ÙØµÙØ±ÙÙŠØŒ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙ. Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙƒÙÙÙ’Ø±Ù ÙˆÙØ§Ù„Ù’ÙÙÙ‚Ù’Ø±ÙØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù’Ù‚ÙØ¨Ù’Ø±ÙØŒ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙ (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ù„Ø§Ù ÙŠÙØ¶ÙØ±Ù‘Ù Ù…ÙØ¹Ù Ø§Ø³Ù’Ù…ÙÙ‡Ù Ø´ÙÙŠÙ’Ø¡ÙŒ ÙÙÙŠ Ø§Ù„Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„Ø§Ù ÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§Ø¡Ù ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ø³Ù‘ÙÙ…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù (3 Ù…Ø±Ø§Øª)", c:3}
        ],
        evening: [
            {t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1},
            {t:"Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙÙ„ÙÙ…ÙØ§ØªÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„ØªÙ‘ÙØ§Ù…Ù‘ÙØ§ØªÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø£ÙÙ…Ù’Ø³ÙÙŠÙ’Ù†ÙØ§ ÙˆÙØ£ÙÙ…Ù’Ø³ÙÙ‰ Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ Ù„ÙÙ„Ù‘ÙÙ‡ÙØŒ ÙˆÙØ§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡ÙØŒ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ­Ù’Ø¯ÙÙ‡Ù Ù„Ø§Ù Ø´ÙØ±ÙÙŠÙƒÙ Ù„ÙÙ‡ÙØŒ Ù„ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ„ÙÙ‡Ù Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰ ÙƒÙÙ„Ù‘Ù Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø®ÙÙŠÙ’Ø±Ù Ù…ÙØ§ ÙÙÙŠ Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù„Ù‘ÙÙŠÙ’Ù„ÙØ©Ù ÙˆÙØ®ÙÙŠÙ’Ø±Ù Ù…ÙØ§ Ø¨ÙØ¹Ù’Ø¯ÙÙ‡ÙØ§ØŒ ÙˆÙØ£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ ÙÙÙŠ Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ù„Ù‘ÙÙŠÙ’Ù„ÙØ©Ù ÙˆÙØ´ÙØ±Ù‘Ù Ù…ÙØ§ Ø¨ÙØ¹Ù’Ø¯ÙÙ‡ÙØ§ØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù’ÙƒÙØ³ÙÙ„Ù ÙˆÙØ³ÙÙˆØ¡Ù Ø§Ù„Ù’ÙƒÙØ¨ÙØ±ÙØŒ Ø±ÙØ¨Ù‘Ù Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø¹ÙØ°ÙØ§Ø¨Ù ÙÙÙŠ Ø§Ù„Ù†Ù‘ÙØ§Ø±Ù ÙˆÙØ¹ÙØ°ÙØ§Ø¨Ù ÙÙÙŠ Ø§Ù„Ù’Ù‚ÙØ¨Ù’Ø±Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¨ÙÙƒÙ Ø£ÙÙ…Ù’Ø³ÙÙŠÙ’Ù†ÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ø£ÙØµÙ’Ø¨ÙØ­Ù’Ù†ÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ù†ÙØ­Ù’ÙŠÙØ§ØŒ ÙˆÙØ¨ÙÙƒÙ Ù†ÙÙ…ÙÙˆØªÙ ÙˆÙØ¥ÙÙ„ÙÙŠÙ’ÙƒÙ Ø§Ù„Ù’Ù…ÙØµÙÙŠØ±Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø£ÙÙ†Ù’ØªÙ Ø±ÙØ¨Ù‘ÙÙŠ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙØŒ Ø®ÙÙ„ÙÙ‚Ù’ØªÙÙ†ÙÙŠ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙØ¨Ù’Ø¯ÙÙƒÙØŒ ÙˆÙØ£ÙÙ†ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ø¹ÙÙ‡Ù’Ø¯ÙÙƒÙ ÙˆÙÙˆÙØ¹Ù’Ø¯ÙÙƒÙ Ù…ÙØ§ Ø§Ø³Ù’ØªÙØ·ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù’ Ø´ÙØ±Ù‘Ù Ù…ÙØ§ ØµÙÙ†ÙØ¹Ù’ØªÙØŒ Ø£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙÙ†ÙØ¹Ù’Ù…ÙØªÙÙƒÙ Ø¹ÙÙ„ÙÙŠÙ‘ÙØŒ ÙˆÙØ£ÙØ¨ÙÙˆØ¡Ù Ù„ÙÙƒÙ Ø¨ÙØ°ÙÙ†Ù’Ø¨ÙÙŠ ÙÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙÙØ¥ÙÙ†Ù‘ÙÙ‡Ù Ù„Ø§Ù ÙŠÙØºÙ’ÙÙØ±Ù Ø§Ù„Ø°Ù‘ÙÙ†ÙÙˆØ¨Ù Ø¥ÙÙ„Ø§Ù‘Ù Ø£ÙÙ†Ù’ØªÙ.", c:1},
            {t:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù (33)ØŒ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡Ù (33)ØŒ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù (34)", c:1},
            {t:"Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ù„Ø§Ù ÙŠÙØ¶ÙØ±Ù‘Ù Ù…ÙØ¹Ù Ø§Ø³Ù’Ù…ÙÙ‡Ù Ø´ÙÙŠÙ’Ø¡ÙŒ ÙÙÙŠ Ø§Ù„Ø£ÙØ±Ù’Ø¶Ù ÙˆÙÙ„Ø§Ù ÙÙÙŠ Ø§Ù„Ø³Ù‘ÙÙ…ÙØ§Ø¡Ù ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ø³Ù‘ÙÙ…ÙÙŠØ¹Ù Ø§Ù„Ù’Ø¹ÙÙ„ÙÙŠÙ…Ù (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø£ÙØ³Ù’ØªÙØºÙ’ÙÙØ±Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ù„Ø§Ù Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„Ø§Ù‘Ù Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙ‘Ù Ø§Ù„Ù’Ù‚ÙÙŠÙ‘ÙÙˆÙ…Ù ÙˆÙØ£ÙØªÙÙˆØ¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡Ù (3 Ù…Ø±Ø§Øª)", c:3}
        ],
        sleep: [
            {t:"ÙŠÙØ¬Ù’Ù…ÙØ¹Ù ÙƒÙÙÙ‘ÙÙŠÙ’Ù‡Ù Ø«ÙÙ…Ù‘Ù ÙŠÙÙ†Ù’ÙÙØ«Ù ÙÙÙŠÙ‡ÙÙ…ÙØ§ ÙˆÙÙŠÙÙ‚Ù’Ø±ÙØ£Ù: Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø£ÙØ­ÙØ¯ÙŒØŒ ÙˆÙÙ‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨Ù‘Ù Ø§Ù„Ù’ÙÙÙ„ÙÙ‚ÙØŒ ÙˆÙÙ‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨Ù‘Ù Ø§Ù„Ù†Ù‘ÙØ§Ø³ÙØŒ Ø«ÙÙ…Ù‘Ù ÙŠÙÙ…Ù’Ø³ÙØ­Ù Ø¨ÙÙ‡ÙÙ…ÙØ§ Ù…ÙØ§ Ø§Ø³Ù’ØªÙØ·ÙØ§Ø¹Ù Ù…ÙÙ†Ù’ Ø¬ÙØ³ÙØ¯ÙÙ‡ÙØŒ ÙŠÙØ¨Ù’Ø¯ÙØ£Ù Ø¨ÙÙ‡ÙÙ…ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ø±ÙØ£Ù’Ø³ÙÙ‡Ù ÙˆÙÙˆÙØ¬Ù’Ù‡ÙÙ‡Ù ÙˆÙÙ…ÙØ§ Ø£ÙÙ‚Ù’Ø¨ÙÙ„Ù Ù…ÙÙ†Ù’ Ø¬ÙØ³ÙØ¯ÙÙ‡Ù (ÙŠÙÙÙ’Ø¹ÙÙ„Ù Ø°ÙÙ„ÙÙƒÙ Ø«ÙÙ„Ø§ÙØ«Ù Ù…ÙØ±Ù‘ÙØ§ØªÙ)", c:3},
            {t:"Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ", c:1},
            {t:"Ø¨ÙØ§Ø³Ù’Ù…ÙÙƒÙ Ø±ÙØ¨Ù‘ÙÙŠ ÙˆÙØ¶ÙØ¹Ù’ØªÙ Ø¬ÙÙ†Ù’Ø¨ÙÙŠØŒ ÙˆÙØ¨ÙÙƒÙ Ø£ÙØ±Ù’ÙÙØ¹ÙÙ‡ÙØŒ ÙÙØ¥ÙÙ†Ù’ Ø£ÙÙ…Ù’Ø³ÙÙƒÙ’ØªÙ Ù†ÙÙÙ’Ø³ÙÙŠ ÙÙØ§Ø±Ù’Ø­ÙÙ…Ù’Ù‡ÙØ§ØŒ ÙˆÙØ¥ÙÙ†Ù’ Ø£ÙØ±Ù’Ø³ÙÙ„Ù’ØªÙÙ‡ÙØ§ ÙÙØ§Ø­Ù’ÙÙØ¸Ù’Ù‡ÙØ§ØŒ Ø¨ÙÙ…ÙØ§ ØªÙØ­Ù’ÙÙØ¸Ù Ø¨ÙÙ‡Ù Ø¹ÙØ¨ÙØ§Ø¯ÙÙƒÙ Ø§Ù„ØµÙ‘ÙØ§Ù„ÙØ­ÙÙŠÙ†Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙƒÙ Ø®ÙÙ„ÙÙ‚Ù’ØªÙ Ù†ÙÙÙ’Ø³ÙÙŠ ÙˆÙØ£ÙÙ†Ù’ØªÙ ØªÙÙˆÙÙÙ‘ÙØ§Ù‡ÙØ§ØŒ Ù„ÙÙƒÙ Ù…ÙÙ…ÙØ§ØªÙÙ‡ÙØ§ ÙˆÙÙ…ÙØ­Ù’ÙŠÙØ§Ù‡ÙØ§ØŒ Ø¥ÙÙ†Ù’ Ø£ÙØ­Ù’ÙŠÙÙŠÙ’ØªÙÙ‡ÙØ§ ÙÙØ§Ø­Ù’ÙÙØ¸Ù’Ù‡ÙØ§ØŒ ÙˆÙØ¥ÙÙ†Ù’ Ø£ÙÙ…ÙØªÙ‘ÙÙ‡ÙØ§ ÙÙØ§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙ‡ÙØ§. Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ø¥ÙÙ†Ù‘ÙÙŠ Ø£ÙØ³Ù’Ø£ÙÙ„ÙÙƒÙ Ø§Ù„Ù’Ø¹ÙØ§ÙÙÙŠÙØ©Ù.", c:1},
            {t:"Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ù‚ÙÙ†ÙÙŠ Ø¹ÙØ°ÙØ§Ø¨ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù ØªÙØ¨Ù’Ø¹ÙØ«Ù Ø¹ÙØ¨ÙØ§Ø¯ÙÙƒÙ (3 Ù…Ø±Ø§Øª)", c:3},
            {t:"Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù (33)ØŒ Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„Ù‘ÙÙ‡Ù (33)ØŒ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø£ÙÙƒÙ’Ø¨ÙØ±Ù (34)", c:1}
        ]
    };

    function renderAdhkar(type) {
        const c = $('adhkarContainer'); c.innerHTML = "";
        if (!adhkarDB[type]) return;
        
        adhkarDB[type].forEach((item, i) => {
            if (!data.adhkarProgress[type]) data.adhkarProgress[type] = {};
            if (data.adhkarProgress[type][i] === undefined) data.adhkarProgress[type][i] = item.c;

            const div = document.createElement('div'); div.className = "dhikr-card";
            const currentCount = data.adhkarProgress[type][i];
            
            div.innerHTML = `<div class="dhikr-text">${item.t}</div><div class="dhikr-footer"><span>Ø§Ø¶ØºØ· Ù„Ù„Ø¹Ø¯</span><div class="count-badge" id="ad-cnt-${i}">${currentCount}</div></div>`;
            
            div.onclick = () => { 
                if(currentCount > 0){
                    data.adhkarProgress[type][i]--;
                    const badge = $(`ad-cnt-${i}`);
                    if(badge) badge.innerText = data.adhkarProgress[type][i];
                    saveData();
                    if(data.adhkarProgress[type][i] === 0) {
                        div.classList.add('done');
                        showToast('Ø£ØªÙ…Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø°ÙƒØ±!', 'success');
                    }
                }
            };
            if(currentCount === 0) div.classList.add('done');
            c.appendChild(div);
        });
    }

    // --- HISTORY LOGS ---
    function renderHistoryLogs() {
        if (!Array.isArray(data.monthly)) data.monthly = [];
        if (!Array.isArray(data.quarterly)) data.quarterly = [];
        if (!Array.isArray(data.yearly)) data.yearly = [];

        const logMonth = data.monthly.filter(i => i.checked);
        const logQuarter = data.quarterly.filter(i => i.checked);
        const logYear = data.yearly.filter(i => i.checked);

        renderSimpleList('log_monthly', logMonth);
        renderSimpleList('log_quarterly', logQuarter);
        renderSimpleList('log_yearly', logYear);
    }

    function renderSimpleList(elementId, items) {
        const list = $(elementId);
        if (!list) return;
        list.innerHTML = "";
        if (items.length === 0) {
            list.innerHTML = `<li style="justify-content:center; color:#64748b;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø¨Ø¹Ø¯</li>`;
            return;
        }
        items.forEach(item => {
            const li = document.createElement('li');
            li.innerHTML = `<span>${item.text}</span><i class="fas fa-check-circle" style="color:var(--success)"></i>`;
            list.appendChild(li);
        });
    }

    // --- UTILITIES ---
    function navTo(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        
        const page = $(id);
        if (page) page.classList.add('active');
        
        const btn = Array.from(document.querySelectorAll('.nav-btn')).find(b => b.getAttribute('onclick').includes(id));
        if (btn) btn.classList.add('active');

        if (window.innerWidth <= 768) {
            const sb = $('sidebar');
            const ov = $('overlay');
            if (sb) sb.classList.remove('open');
            if (ov) ov.classList.remove('active');
        }
    }

    function toggleSidebar() {
        const sb = $('sidebar');
        const ov = $('overlay');
        if (sb) sb.classList.toggle('open');
        if (ov) ov.classList.toggle('active');
    }

    function updateProgressBars() {
        if (!Array.isArray(data.yearly)) return;
        const total = data.yearly.length;
        const done = data.yearly.filter(i => i.checked).length;
        const percent = total === 0 ? 0 : Math.round((done / total) * 100);

        setText('yearlyProgressText', `${percent}%`);
        
        const bar = $('yearlyProgressBar');
        if (bar) bar.style.width = `${percent}%`;
        
        setText('yearlyDoneCount', `${done} Ù…ÙƒØªÙ…Ù„`);
        setText('yearlyTotalCount', `${total} Ø¥Ø¬Ù…Ø§Ù„ÙŠ`);
    }

    function showToast(msg, type = 'success') {
        const container = $('toast-container');
        if (!container) return;
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i> <span>${msg}</span>`;
        container.appendChild(toast);
        setTimeout(() => {
            if (toast.parentNode) {
                toast.style.opacity = '0';
                setTimeout(() => { if (toast.parentNode) toast.remove(); }, 300);
            }
        }, 3000);
    }

    function startClock() {
        const update = () => {
            const now = new Date();
            setText('timeDisplay', now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false }));
            setText('dateDisplay', now.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'numeric' }));
            
            const h = now.getHours();
            const greeting = (h < 12 ? "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±" : (h < 17 ? "Ø·Ø§Ø¨ ÙŠÙˆÙ…Ùƒ" : "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±")) + "ØŒ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…Ù„Ùƒ ğŸ‘‘";
            setText('greetingText', greeting);
        };
        update();
        setInterval(update, 1000);
    }

    function clearData() {
        if (confirm('âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡!')) {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
    }

    function exportData() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
        const a = document.createElement('a');
        a.setAttribute("href", dataStr);
        a.setAttribute("download", "KingsTech_Backup.json");
        document.body.appendChild(a);
        a.click();
        if (a.parentNode) a.parentNode.removeChild(a);
    }

    // --- POMODORO ---
    let pInterval, pSec = 25 * 60;
    function togglePomodoro() {
        const btn = document.querySelector('#spirituality .btn');
        if (pInterval) {
            clearInterval(pInterval);
            pInterval = null;
            if (btn) btn.innerText = "Ø¨Ø¯Ø¡";
        } else {
            if (btn) btn.innerText = "Ø¥ÙŠÙ‚Ø§Ù";
            pInterval = setInterval(() => {
                pSec--;
                if (pSec <= 0) {
                    clearInterval(pInterval);
                    pInterval = null;
                    showToast('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª', 'success');
                    pSec = 25 * 60;
                    if (btn) btn.innerText = "Ø¨Ø¯Ø¡";
                }
                const m = Math.floor(pSec / 60).toString().padStart(2, '0');
                const s = (pSec % 60).toString().padStart(2, '0');
                const timer = $('pomodoroTimer');
                if (timer) timer.innerText = `${m}:${s}`;
            }, 1000);
        }
    }

    function resetPomodoro() {
        clearInterval(pInterval);
        pInterval = null;
        pSec = 25 * 60;
        const timer = $('pomodoroTimer');
        if (timer) timer.innerText = "25:00";
        const btn = document.querySelector('#spirituality .btn');
        if (btn) btn.innerText = "Ø¨Ø¯Ø¡";
    }

    // --- MASBAHA ---
    let mCount = 0;
    function incMasbaha() {
        const numEl = $('dhikrNum');
        if (numEl) {
            mCount++;
            numEl.innerText = mCount;
        }
    }

    function saveXP() {
        showToast('Ø­ÙØ¸ Ø§Ù„ÙˆØ±Ø¯', 'success');
        mCount = 0;
        const numEl = $('dhikrNum');
        if (numEl) numEl.innerText = 0;
    }

    // --- SALAH ---
    function renderSalah() {
        const container = $('salahContainer');
        if (!container) return;
        container.innerHTML = "";
        
        const names = { fajr: "Ø§Ù„ÙØ¬Ø±", dhuhr: "Ø§Ù„Ø¸Ù‡Ø±", asr: "Ø§Ù„Ø¹ØµØ±", maghrib: "Ø§Ù„Ù…ØºØ±Ø¨", isha: "Ø§Ù„Ø¹Ø´Ø§Ø¡" };
        if (!data.salah) data.salah = {};

        for (let key in names) {
            const d = document.createElement('div');
            const isChecked = data.salah[key] ? true : false;
            const bg = isChecked ? 'var(--success)' : 'rgba(255,255,255,0.05)';
            
            d.style = `display:flex; justify-content:space-between; padding:10px; background:${bg}; margin-bottom:5px; border-radius:5px; cursor:pointer; transition:0.2s;`;
            d.innerHTML = `<span>${names[key]}</span><span>${isChecked ? 'âœ…' : 'â­•'}</span>`;
            
            d.onclick = () => {
                data.salah[key] = !data.salah[key];
                saveData();
                renderSalah();
            };
            container.appendChild(d);
        }
    }

    // --- KANBAN ---
    function addKB() {
        const input = $('kb_in');
        if (input && input.value.trim()) {
            if (!data.kanban) data.kanban = { todo: [], doing: [], done: [] };
            data.kanban.todo.push(input.value);
            input.value = "";
            saveData();
            renderKanban();
        }
    }

    function renderKanban() {
        ['todo', 'doing', 'done'].forEach(k => {
            const div = $(`kb_${k}`);
            if (!div) return;
            div.innerHTML = "";
            
            if (!data.kanban || !Array.isArray(data.kanban[k])) return;
            
            data.kanban[k].forEach((t, i) => {
                div.innerHTML += `
                    <div style="background:rgba(255,255,255,0.1); padding:8px; margin-bottom:5px; border-radius:5px; display:flex; justify-content:space-between;">
                        <span onclick="moveKB('${k}',${i})" style="cursor:pointer; flex:1">${t}</span>
                        <i class="fas fa-times" style="color:var(--danger); cursor:pointer" onclick="delKB('${k}',${i})"></i>
                    </div>`;
            });
        });
    }

    function moveKB(from, idx) {
        if (!data.kanban || !data.kanban[from]) return;
        let to = from === 'todo' ? 'doing' : (from === 'doing' ? 'done' : null);
        if (to) {
            if (!Array.isArray(data.kanban[to])) data.kanban[to] = [];
            data.kanban[to].push(data.kanban[from].splice(idx, 1)[0]);
            saveData();
            renderKanban();
        }
    }

    function delKB(key, idx) {
        if (data.kanban && Array.isArray(data.kanban[key])) {
            data.kanban[key].splice(idx, 1);
            saveData();
            renderKanban();
        }
    }
    </script>
</body>
</html>
